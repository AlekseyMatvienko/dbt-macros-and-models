{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-12-03T11:06:40.568276Z", "invocation_id": "5c106e9b-6d11-4168-9f39-93e8b4113410", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-03T11:06:40.020078Z", "completed_at": "2024-12-03T11:06:40.074287Z"}, {"name": "execute", "started_at": "2024-12-03T11:06:40.075270Z", "completed_at": "2024-12-03T11:06:40.407191Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3906989097595215, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.subway_project.ins_upd_to_dim_client", "compiled": true, "compiled_code": "\n\n-- sal_table (source(sal_name))\n-- pit_table (source(pit_name), (sat_col_name, ))\n-- entity_key 'entity_key'\n-- sat_tables ((source(sat_name), sat_name, (columns, ), sat_type, oid), )\n-- columns_name (column_name, )\n\nwith unif_dim as\n(\n\tselect sal.client_rk, \n\t\tsource_system_dk, \n\t\tvalid_from_dttm, \n        \n            client_name_desc\n         , \n        \n            client_phone_desc\n         , \n        \n            client_city_desc\n         , \n        \n            client_birthday_dt\n        \n        \n\tfrom\n\t\"postgres\".\"dbt_schema\".\"GPR_BV_A_CLIENT\" sal\n\tjoin (\n    \n\t\n\t\tselect \n\t\tclient_rk, \n\t\tsource_system_dk, \n\t\tvalid_from_dttm, \n        \n           name_desc client_name_desc\n         , \n        \n           phone_desc client_phone_desc\n         , \n        \n           city_desc client_city_desc\n         , \n        \n           birthday_dt client_birthday_dt\n        \n        \n\t\tfrom \"postgres\".\"dbt_schema\".\"GPR_RV_M_CLIENT_SUBWAY_STAR\"\n\t\twhere \n         row_num = 1 and \n\t\tactual_flg = 1\n         union all \n\t\t\n\t\n\t\tselect \n\t\tclient_rk, \n\t\tsource_system_dk, \n\t\tvalid_from_dttm, \n        \n           fio_desc client_name_desc\n         , \n        \n           phone_desc client_phone_desc\n         , \n        \n           null client_city_desc\n         , \n        \n           birthday_dt client_birthday_dt\n        \n        \n\t\tfrom \"postgres\".\"dbt_schema\".\"GPR_RV_M_CLIENT_PROFILE_POST\"\n\t\twhere \n         row_num = 1 and \n\t\tactual_flg = 1\n         union all \n\t\t\n\t\n\t\tselect \n\t\tclient_rk, \n\t\tsource_system_dk, \n\t\tvalid_from_dttm, \n        \n           name_desc client_name_desc\n         , \n        \n           null client_phone_desc\n         , \n        \n           null client_city_desc\n         , \n        \n           birthdate_dt client_birthday_dt\n        \n        \n\t\tfrom \"postgres\".\"dbt_schema\".\"GPR_RV_S_CLIENT_CLIENT_FIREBIRD\"\n\t\twhere \n        \n\t\tactual_flg = 1\n        \n\t\t\n\t) sat\n\ton sal.x_client_rk = sat.client_rk\n)\n\nselect * from\n(\n\n\tselect \n\t'manual__2024-12-03T11:00:52.076204+00:00' dataflow_id,\n\t'2024-12-03 11:00:52.076204+00:00'::timestamp dataflow_dttm,\n\tpit.client_rk,\n\tpit.valid_from_dttm,\n\tpit.valid_to_dttm,\n    \n\tcase \n        \n\t\twhen unif_dim_GPR_RV_M_CLIENT_SUBWAY_STAR.valid_from_dttm != '1960-01-01' \n\t\tthen unif_dim_GPR_RV_M_CLIENT_SUBWAY_STAR.client_name_desc \n        \n\t\twhen unif_dim_GPR_RV_M_CLIENT_PROFILE_POST.valid_from_dttm != '1960-01-01' \n\t\tthen unif_dim_GPR_RV_M_CLIENT_PROFILE_POST.client_name_desc \n        \n\t\twhen unif_dim_GPR_RV_S_CLIENT_CLIENT_FIREBIRD.valid_from_dttm != '1960-01-01' \n\t\tthen unif_dim_GPR_RV_S_CLIENT_CLIENT_FIREBIRD.client_name_desc \n        \n\tend client_name_desc\n     ,   \n    \n\tcase \n        \n\t\twhen unif_dim_GPR_RV_M_CLIENT_SUBWAY_STAR.valid_from_dttm != '1960-01-01' \n\t\tthen unif_dim_GPR_RV_M_CLIENT_SUBWAY_STAR.client_phone_desc \n        \n\t\twhen unif_dim_GPR_RV_M_CLIENT_PROFILE_POST.valid_from_dttm != '1960-01-01' \n\t\tthen unif_dim_GPR_RV_M_CLIENT_PROFILE_POST.client_phone_desc \n        \n\t\twhen unif_dim_GPR_RV_S_CLIENT_CLIENT_FIREBIRD.valid_from_dttm != '1960-01-01' \n\t\tthen unif_dim_GPR_RV_S_CLIENT_CLIENT_FIREBIRD.client_phone_desc \n        \n\tend client_phone_desc\n     ,   \n    \n\tcase \n        \n\t\twhen unif_dim_GPR_RV_M_CLIENT_SUBWAY_STAR.valid_from_dttm != '1960-01-01' \n\t\tthen unif_dim_GPR_RV_M_CLIENT_SUBWAY_STAR.client_city_desc \n        \n\t\twhen unif_dim_GPR_RV_M_CLIENT_PROFILE_POST.valid_from_dttm != '1960-01-01' \n\t\tthen unif_dim_GPR_RV_M_CLIENT_PROFILE_POST.client_city_desc \n        \n\t\twhen unif_dim_GPR_RV_S_CLIENT_CLIENT_FIREBIRD.valid_from_dttm != '1960-01-01' \n\t\tthen unif_dim_GPR_RV_S_CLIENT_CLIENT_FIREBIRD.client_city_desc \n        \n\tend client_city_desc\n     ,   \n    \n\tcase \n        \n\t\twhen unif_dim_GPR_RV_M_CLIENT_SUBWAY_STAR.valid_from_dttm != '1960-01-01' \n\t\tthen unif_dim_GPR_RV_M_CLIENT_SUBWAY_STAR.client_birthday_dt \n        \n\t\twhen unif_dim_GPR_RV_M_CLIENT_PROFILE_POST.valid_from_dttm != '1960-01-01' \n\t\tthen unif_dim_GPR_RV_M_CLIENT_PROFILE_POST.client_birthday_dt \n        \n\t\twhen unif_dim_GPR_RV_S_CLIENT_CLIENT_FIREBIRD.valid_from_dttm != '1960-01-01' \n\t\tthen unif_dim_GPR_RV_S_CLIENT_CLIENT_FIREBIRD.client_birthday_dt \n        \n\tend client_birthday_dt\n      \n    \n\n\tfrom \n\t\t(\n\t\tselect \n\t\tclient_rk, \n\t\tvalid_from_dttm, \n\t\tvalid_to_dttm,\n         \n\t\t\tclient_subway_star_vf_dttm\n\t\t ,   \n         \n\t\t\tprofile_client_post_vf_dttm\n\t\t  \n        \n\n\t\tfrom \"postgres\".\"dbt_schema\".\"GPR_BV_P_CLIENT\"\n\t\t--where valid_to_dttm = '5999-01-01'\n\t\twhere dataflow_dttm = '2024-12-03 11:00:52.076204+00:00'::timestamp\n\t\t) pit\n\t\n\tleft join \n     \n\t\n\t\t(select * from unif_dim where source_system_dk = 3515641477) unif_dim_GPR_RV_M_CLIENT_SUBWAY_STAR\n\t    on pit.client_rk = unif_dim_GPR_RV_M_CLIENT_SUBWAY_STAR.client_rk\n\t left join   \n     \n\t\n\t\t(select * from unif_dim where source_system_dk = 107023) unif_dim_GPR_RV_M_CLIENT_PROFILE_POST\n\t    on pit.client_rk = unif_dim_GPR_RV_M_CLIENT_PROFILE_POST.client_rk\n\t left join   \n     \n\t\n\t\t(select * from unif_dim where source_system_dk = 1) unif_dim_GPR_RV_S_CLIENT_CLIENT_FIREBIRD\n\t    on pit.client_rk = unif_dim_GPR_RV_S_CLIENT_CLIENT_FIREBIRD.client_rk\n\t  \n    \n)\n\nwhere \n\n    client_name_desc is not null\n or \n\n    client_phone_desc is not null\n or \n\n    client_city_desc is not null\n or \n\n    client_birthday_dt is not null\n\n\n\n\n\n\n--depends on \"postgres\".\"dbt_schema\".\"GPR_RV_M_CLIENT_SUBWAY_STAR\"\n--depends on \"postgres\".\"dbt_schema\".\"GPR_RV_M_CLIENT_PROFILE_POST\"\n--depends on \"postgres\".\"dbt_schema\".\"GPR_RV_S_CLIENT_CLIENT_FIREBIRD\"\n--depends on \"postgres\".\"dbt_schema\".\"GPR_BV_A_CLIENT\"\n--depends on \"postgres\".\"dbt_schema\".\"GPR_BV_P_CLIENT\"", "relation_name": "\"postgres\".\"dbt_schema\".\"ins_upd_to_dim_client\""}], "elapsed_time": 2.41780686378479, "args": {"warn_error_options": {"include": [], "exclude": []}, "favor_state": false, "invocation_command": "dbt run --models ins_upd_to_dim_client.sql --vars {execution_date : 2024-12-03 11:00:52.076204+00:00 , run_id :  manual__2024-12-03T11:00:52.076204+00:00 }", "project_dir": "/home/anarisuto-12/dbt/subway_project", "profiles_dir": "/home/anarisuto-12/.dbt", "partial_parse": true, "introspect": true, "defer": false, "cache_selected_only": false, "write_json": true, "printer_width": 80, "log_format": "default", "log_level": "info", "quiet": false, "source_freshness_run_project_hooks": false, "static_parser": true, "use_colors": true, "log_file_max_bytes": 10485760, "enable_legacy_logger": false, "exclude": [], "populate_cache": true, "show_resource_report": false, "log_path": "/home/anarisuto-12/dbt/subway_project/logs", "print": true, "partial_parse_file_diff": true, "macro_debugging": false, "send_anonymous_usage_stats": true, "vars": {"execution_date": "2024-12-03T11:00:52.076204+00:00", "run_id": "manual__2024-12-03T11:00:52.076204+00:00"}, "version_check": true, "require_explicit_package_overrides_for_builtin_materializations": true, "which": "run", "indirect_selection": "eager", "use_colors_file": true, "empty": false, "select": ["ins_upd_to_dim_client.sql"], "log_level_file": "debug", "require_resource_names_without_spaces": false, "strict_mode": false, "log_format_file": "debug"}}